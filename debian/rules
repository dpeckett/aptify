#!/usr/bin/make -f

export DEB_HOST_MULTIARCH ?= $(shell dpkg-architecture -qDEB_HOST_MULTIARCH)
export VERSION ?= $(shell git describe --tags --abbrev=0)

%:
	dh $@ --builddirectory=_build --buildsystem=golang

override_dh_auto_build:
	dh_auto_build -- -ldflags "-X 'github.com/dpeckett/aptify/internal/constants.Version=$(VERSION)'"

override_dh_auto_install:
	dh_auto_install -- --no-source

override_dh_shlibdeps:
	dh_shlibdeps -l/usr/$(DEB_HOST_MULTIARCH)/lib